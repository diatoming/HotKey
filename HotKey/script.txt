tell application "Finder"
    try
        if selection is not {}
            set myname to POSIX path of (selection as alias)
        else
            set myname to POSIX path of (target of window 1 as alias)
        end if
    on error
        set myname to POSIX path of (home as alias)
    end try
end tell